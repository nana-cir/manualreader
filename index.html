<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NANA View - Manual Leader</title>
    <style>
        :root {
            --primary-color: #0056b3;
            --accent-color: #ff4757;
            --bg-color: #f0f2f5;
            --text-color: #333;
            --modal-bg: rgba(0, 0, 0, 0.6);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            margin: 0; padding: 0; background-color: var(--bg-color); color: var(--text-color);
            height: 100vh; display: flex; flex-direction: column; overflow: hidden;
        }

        /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
        header {
            background: white; padding: 15px;
            display: flex; justify-content: space-between; align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05); z-index: 10;
        }
        .app-name { font-weight: bold; font-size: 1.2rem; color: var(--primary-color); }
        
        /* è¨€èªåˆ‡æ›¿ãƒœã‚¿ãƒ³ï¼ˆçµµæ–‡å­—ä½¿ç”¨ï¼‰ */
        .lang-switch {
            background: #f0f0f0; border: 1px solid #ddd; padding: 6px 12px; border-radius: 20px;
            font-size: 0.95rem; cursor: pointer; display: flex; align-items: center;
            transition: background 0.2s;
        }
        .lang-switch:active { background: #e0e0e0; }

        /* ãƒ¡ã‚¤ãƒ³ã‚¨ãƒªã‚¢ */
        main { 
            flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; 
            padding: 20px; position: relative;
        }

        /* å›ç­”ã‚¨ãƒªã‚¢ */
        #response-area {
            width: 100%; max-width: 600px; height: 35vh; overflow-y: auto;
            background: white; border-radius: 15px; padding: 20px; margin-bottom: 30px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05); display: none;
        }
        .bubble { background: #eef2ff; padding: 15px; border-radius: 12px; line-height: 1.6; border-left: 5px solid var(--primary-color); }

        /* ãƒã‚¤ã‚¯ãƒœã‚¿ãƒ³ï¼ˆçµµæ–‡å­—ä½¿ç”¨ï¼‰ */
        .mic-container { position: relative; }
        #mic-btn {
            width: 120px; height: 120px; border-radius: 50%;
            background: linear-gradient(145deg, #0063cc, #0056b3);
            border: none; color: white; font-size: 4rem; /* çµµæ–‡å­—ã‚µã‚¤ã‚º */
            box-shadow: 0 10px 20px rgba(0, 86, 179, 0.3);
            cursor: pointer; display: flex; align-items: center; justify-content: center;
            transition: transform 0.1s;
        }
        #mic-btn:active { transform: scale(0.95); }
        #mic-btn.listening { animation: pulse 1.5s infinite; background: var(--accent-color); }
        
        @keyframes pulse { 
            0% { box-shadow: 0 0 0 0 rgba(255, 71, 87, 0.7); } 
            70% { box-shadow: 0 0 0 20px rgba(0,0,0,0); } 
            100% { box-shadow: 0 0 0 0 rgba(0,0,0,0); } 
        }

        #status-text { margin-top: 20px; font-size: 1.1rem; color: #666; font-weight: bold; min-height: 1.5rem; }

        /* ãƒ•ãƒƒã‚¿ãƒ¼ï¼ˆãƒ¢ãƒ¼ãƒ‰é¸æŠï¼‰ */
        footer { background: white; padding: 15px 10px; box-shadow: 0 -2px 10px rgba(0,0,0,0.05); z-index: 10; }
        .mode-selector { display: flex; justify-content: space-around; max-width: 600px; margin: 0 auto; gap: 10px; }
        .mode-btn { 
            background: none; border: 2px solid #ddd; border-radius: 25px; 
            padding: 10px 0; font-size: 0.85rem; color: #666; width: 32%; 
            font-weight: bold; cursor: pointer; transition: all 0.2s;
        }
        .mode-btn.active { border-color: var(--primary-color); background: var(--primary-color); color: white; }
        /* ãƒˆãƒ©ãƒ–ãƒ«ãƒ¢ãƒ¼ãƒ‰ã ã‘èµ¤ãã™ã‚‹ */
        .mode-btn[data-mode="trouble"].active { border-color: var(--accent-color); background: var(--accent-color); }

        /* --- è¨€èªé¸æŠãƒ¢ãƒ¼ãƒ€ãƒ« --- */
        #lang-modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--modal-bg); z-index: 2000;
            justify-content: center; align-items: center;
            opacity: 0; transition: opacity 0.2s;
        }
        #lang-modal.show { display: flex; opacity: 1; }
        
        .lang-list-container {
            background: white; width: 90%; max-width: 350px; max-height: 80vh;
            border-radius: 15px; overflow: hidden; display: flex; flex-direction: column;
        }
        .lang-header {
            padding: 15px; background: #f8f9fa; border-bottom: 1px solid #eee;
            font-weight: bold; text-align: center; font-size: 1.1rem;
        }
        .lang-list { overflow-y: auto; }
        .lang-item {
            padding: 15px 20px; border-bottom: 1px solid #eee; font-size: 1rem;
            cursor: pointer; display: flex; justify-content: space-between; align-items: center;
        }
        .lang-item:active { background: #eef2ff; }
        .lang-check { color: var(--primary-color); font-weight: bold; display: none; }
        .lang-item.selected .lang-check { display: block; }
        
        .modal-close-area { flex:1; } /* ãƒ¢ãƒ¼ãƒ€ãƒ«å¤–ã‚¯ãƒªãƒƒã‚¯ç”¨ */

    </style>
</head>
<body>

    <header>
        <div class="app-name">NANA View</div>
        <button class="lang-switch" onclick="openLangModal()">
            <span style="font-size:1.2rem; margin-right:5px;">ğŸŒ</span>
            <span id="header-lang-name">æ—¥æœ¬èª</span>
        </button>
    </header>

    <main>
        <div id="response-area"><div id="ai-response" class="bubble"></div></div>
        
        <div class="mic-container">
            <button id="mic-btn">ğŸ™ï¸</button>
        </div>
        <div id="status-text" data-key="tap_to_speak">ã‚¿ãƒƒãƒ—ã—ã¦è©±ã™</div>
    </main>

    <footer>
        <div class="mode-selector">
            <button class="mode-btn active" onclick="setMode('beginner', this)" data-key="mode_beginner">ğŸ”° åˆå¿ƒè€…</button>
            <button class="mode-btn" onclick="setMode('pro', this)" data-key="mode_pro">âš¡ ãƒ—ãƒ­</button>
            <button class="mode-btn" onclick="setMode('trouble', this)" data-key="mode_trouble" data-mode="trouble">ğŸš¨ ãƒˆãƒ©ãƒ–ãƒ«</button>
        </div>
    </footer>

    <div id="lang-modal">
        <div class="modal-close-area" onclick="closeLangModal()"></div>
        <div class="lang-list-container">
            <div class="lang-header">Select Language</div>
            <div class="lang-list" id="lang-list-body">
                </div>
        </div>
        <div class="modal-close-area" onclick="closeLangModal()"></div>
    </div>

    <script>
        // --- å¤šè¨€èªè¾æ›¸ãƒ‡ãƒ¼ã‚¿ (10ãƒ¶å›½èªå¯¾å¿œ) ---
        const dictionary = {
            ja: { name: "æ—¥æœ¬èª", tap_to_speak: "ã‚¿ãƒƒãƒ—ã—ã¦è©±ã™", listening: "èã„ã¦ã„ã¾ã™...", mode_beginner: "ğŸ”° åˆå¿ƒè€…", mode_pro: "âš¡ ãƒ—ãƒ­", mode_trouble: "ğŸš¨ ãƒˆãƒ©ãƒ–ãƒ«", ai_demo: "ã€ãƒ‡ãƒ¢ã€‘<br>ã“ã‚Œã¯æ—¥æœ¬èªã®ç”»é¢ã§ã™ã€‚<br>ã‚³ãƒ³ã‚»ãƒ³ãƒˆã‚’æŠœã„ã¦å†èµ·å‹•ã—ã¦ãã ã•ã„ã€‚" },
            en: { name: "English", tap_to_speak: "Tap to speak", listening: "Listening...", mode_beginner: "ğŸ”° Beginner", mode_pro: "âš¡ Pro", mode_trouble: "ğŸš¨ Trouble", ai_demo: "ã€Demoã€‘<br>This is the English screen.<br>Please unplug and restart." },
            vi: { name: "Tiáº¿ng Viá»‡t", tap_to_speak: "Cháº¡m Ä‘á»ƒ nÃ³i", listening: "Äang nghe...", mode_beginner: "ğŸ”° NgÆ°á»i má»›i", mode_pro: "âš¡ ChuyÃªn gia", mode_trouble: "ğŸš¨ Sá»± cá»‘", ai_demo: "ã€Demoã€‘<br>ÄÃ¢y lÃ  mÃ n hÃ¬nh Tiáº¿ng Viá»‡t.<br>Vui lÃ²ng rÃºt phÃ­ch cáº¯m vÃ  khá»Ÿi Ä‘á»™ng láº¡i." },
            ne: { name: "à¤¨à¥‡à¤ªà¤¾à¤²à¥€", tap_to_speak: "à¤¬à¥‹à¤²à¥à¤¨ à¤Ÿà¥à¤¯à¤¾à¤ª à¤—à¤°à¥à¤¨à¥à¤¹à¥‹à¤¸à¥", listening: "à¤¸à¥à¤¨à¥à¤¦à¥ˆ...", mode_beginner: "ğŸ”° à¤¶à¥à¤°à¥à¤µà¤¾à¤¤", mode_pro: "âš¡ à¤ªà¥à¤°à¥‹", mode_trouble: "ğŸš¨ à¤¸à¤®à¤¸à¥à¤¯à¤¾", ai_demo: "ã€Demoã€‘<br>à¤¯à¥‹ à¤¨à¥‡à¤ªà¤¾à¤²à¥€ à¤¸à¥à¤•à¥à¤°à¤¿à¤¨ à¤¹à¥‹ã€‚<br>à¤•à¥ƒà¤ªà¤¯à¤¾ à¤…à¤¨à¤ªà¥à¤²à¤— à¤—à¤°à¥à¤¨à¥à¤¹à¥‹à¤¸à¥ à¤° à¤ªà¥à¤¨à¤ƒart à¤—à¤°à¥à¤¨à¥à¤¹à¥‹à¤¸à¥ã€‚" },
            my: { name: "á€™á€¼á€”á€ºá€™á€¬", tap_to_speak: "á€•á€¼á€±á€¬á€›á€”á€º á€”á€¾á€­á€•á€ºá€•á€«", listening: "á€”á€¬á€¸á€‘á€±á€¬á€„á€ºá€”á€±á€á€Šá€º...", mode_beginner: "ğŸ”° á€¡á€…á€•á€¼á€¯á€á€°", mode_pro: "âš¡ á€€á€»á€½á€™á€ºá€¸á€€á€»á€„á€º", mode_trouble: "ğŸš¨ á€•á€¼á€¿á€”á€¬", ai_demo: "ã€Demoã€‘<br>á€’á€«á€€ á€™á€¼á€”á€ºá€™á€¬á€™á€»á€€á€ºá€”á€¾á€¬á€•á€¼á€„á€ºá€•á€«á‹" },
            zh: { name: "ä¸­æ–‡", tap_to_speak: "ç‚¹å‡»è¯´è¯", listening: "æ­£åœ¨å¬...", mode_beginner: "ğŸ”° åˆå­¦è€…", mode_pro: "âš¡ ä¸“ä¸š", mode_trouble: "ğŸš¨ æ•…éšœ", ai_demo: "ã€æ¼”ç¤ºã€‘<br>è¿™æ˜¯ä¸­æ–‡ç•Œé¢ã€‚<br>è¯·æ‹”æ‰ç”µæºå¹¶é‡å¯ã€‚" },
            id: { name: "Indonesia", tap_to_speak: "Ketuk untuk bicara", listening: "Mendengarkan...", mode_beginner: "ğŸ”° Pemula", mode_pro: "âš¡ Ahli", mode_trouble: "ğŸš¨ Masalah", ai_demo: "ã€Demoã€‘<br>Ini layar bahasa Indonesia." },
            tl: { name: "Tagalog", tap_to_speak: "I-tap para magsalita", listening: "Nakikinig...", mode_beginner: "ğŸ”° Baguhan", mode_pro: "âš¡ Pro", mode_trouble: "ğŸš¨ Problema", ai_demo: "ã€Demoã€‘<br>Ito ang screen ng Tagalog." },
            ko: { name: "í•œêµ­ì–´", tap_to_speak: "íƒ­í•˜ì—¬ ë§í•˜ê¸°", listening: "ë“£ê³  ìˆì–´ìš”...", mode_beginner: "ğŸ”° ì´ˆë³´ì", mode_pro: "âš¡ í”„ë¡œ", mode_trouble: "ğŸš¨ íŠ¸ëŸ¬ë¸”", ai_demo: "ã€ë°ëª¨ã€‘<br>í•œêµ­ì–´ í™”ë©´ì…ë‹ˆë‹¤." },
            pt: { name: "PortuguÃªs", tap_to_speak: "Toque para falar", listening: "Ouvindo...", mode_beginner: "ğŸ”° Iniciante", mode_pro: "âš¡ Pro", mode_trouble: "ğŸš¨ Problema", ai_demo: "ã€Demoã€‘<br>Esta Ã© a tela em PortuguÃªs." }
        };

        let currentLang = 'ja';
        let currentMode = 'beginner';

        // --- åˆæœŸåŒ– ---
        window.onload = function() {
            // 1. è¨€èªãƒªã‚¹ãƒˆã‚’ç”Ÿæˆ
            const listBody = document.getElementById('lang-list-body');
            Object.keys(dictionary).forEach(key => {
                const item = document.createElement('div');
                item.className = 'lang-item';
                item.id = `lang-item-${key}`;
                item.onclick = () => selectLang(key);
                item.innerHTML = `
                    <span style="font-weight:bold;">${dictionary[key].name}</span>
                    <span class="lang-check">âœ”</span>
                `;
                listBody.appendChild(item);
            });

            // 2. è¨€èªè¨­å®šã®èª­ã¿è¾¼ã¿ï¼ˆä¿å­˜å€¤ > ãƒ–ãƒ©ã‚¦ã‚¶è¨­å®š > ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰
            const savedLang = localStorage.getItem('nana_app_lang');
            if (savedLang && dictionary[savedLang]) {
                currentLang = savedLang;
            } else {
                // ãƒ–ãƒ©ã‚¦ã‚¶ã®è¨€èªè¨­å®šã‚’ç¢ºèª
                const browserLang = (navigator.language || navigator.userLanguage).slice(0, 2);
                if (dictionary[browserLang]) {
                    currentLang = browserLang;
                }
            }

            applyLanguage(currentLang);
        };

        // --- è¨€èªé¸æŠãƒ¢ãƒ¼ãƒ€ãƒ«åˆ¶å¾¡ ---
        function openLangModal() {
            const modal = document.getElementById('lang-modal');
            modal.classList.add('show');
            
            // ç¾åœ¨ã®è¨€èªã‚’é¸æŠçŠ¶æ…‹ã«ã™ã‚‹
            document.querySelectorAll('.lang-item').forEach(el => el.classList.remove('selected'));
            document.getElementById(`lang-item-${currentLang}`).classList.add('selected');
        }

        function closeLangModal() {
            document.getElementById('lang-modal').classList.remove('show');
        }

        function selectLang(langKey) {
            currentLang = langKey;
            localStorage.setItem('nana_app_lang', currentLang); // ä¿å­˜
            applyLanguage(currentLang);
            closeLangModal();
        }

        function applyLanguage(lang) {
            const data = dictionary[lang];
            
            // ãƒ˜ãƒƒãƒ€ãƒ¼è¡¨ç¤ºæ›´æ–°
            document.getElementById('header-lang-name').innerText = data.name;

            // å„ãƒ†ã‚­ã‚¹ãƒˆã®æ›´æ–° (data-keyå±æ€§ã‚’æŒã¤ã‚‚ã®)
            document.querySelectorAll('[data-key]').forEach(el => {
                const key = el.getAttribute('data-key');
                if (data[key]) el.innerText = data[key];
            });

            // ãƒã‚¤ã‚¯å¾…æ©Ÿä¸­ã®ãƒ†ã‚­ã‚¹ãƒˆæ›´æ–°
            if (!micBtn.classList.contains('listening')) {
                document.getElementById('status-text').innerText = data.tap_to_speak;
            }
        }

        // --- ãƒã‚¤ã‚¯ãƒœã‚¿ãƒ³ & ãƒ¢ãƒ¼ãƒ‰é¸æŠï¼ˆå‰å›åŒæ§˜ï¼‰ ---
        const micBtn = document.getElementById('mic-btn');
        const statusText = document.getElementById('status-text');
        const responseArea = document.getElementById('response-area');
        const aiResponse = document.getElementById('ai-response');

        function setMode(mode, btn) {
            currentMode = mode;
            document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        }

        micBtn.addEventListener('click', () => {
            if (micBtn.classList.contains('listening')) return;
            micBtn.classList.add('listening');
            
            statusText.innerText = dictionary[currentLang].listening;
            responseArea.style.display = 'none';

            // ç–‘ä¼¼AIå¿œç­”ï¼ˆ1.5ç§’å¾Œï¼‰
            setTimeout(() => {
                micBtn.classList.remove('listening');
                statusText.innerText = dictionary[currentLang].tap_to_speak;
                responseArea.style.display = 'block';
                aiResponse.innerHTML = dictionary[currentLang].ai_demo;
            }, 1500);
        });

    </script>
</body>
</html>
